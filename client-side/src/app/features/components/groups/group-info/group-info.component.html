<!-- group details modal -->

<div class="d-flex justify-content-center align-items-center">
  <div class="container m-5 p-5 border border-bottom">

    <div class=" font-weight-bold">
      <h3 class="text-monospace font-italic"><strong>Group details</strong>
        <p></p>
        <p style="font-size: small" class="blockquote-footer my-0">
          {{groupDescription}}
        </p>
      </h3>
    </div>
    <div class="container mt-2 mb-2">
      <div class="modal-body card border-light">

        <div class="d-flex">
          <strong class="text-monospace font-italic font-weight-bolder h5">
            Group members</strong>
          <div class="ml-auto mr-5">
            <div class="row">
              <div class="d-flex">
                <div class="d-flex justify-content-center form-group">
                  <label for="typeahead-member"></label>
                  <input id="typeahead-member" type="text"
                         class="form-control mx-sm-3 bg-light"
                         [class.is-invalid]="usernameSearchFailed"
                         [class.is-valid]="verifyMember()"
                         [(ngModel)]="memberModel" name="addMemberInput"
                         [inputFormatter]="Memberformatter"
                         [resultFormatter]="Memberformatter"
                         [ngbTypeahead]="usernameList"
                         placeholder="username"/>
                  <br>
                  <small *ngIf="searchingUsernames"
                         class="form-text text-muted">searching...</small>
                  <div class="invalid-feedback" *ngIf="usernameSearchFailed">
                    Sorry, no user was found with this username : {{memberModel}}
                  </div>
                </div>
                <div class="ml-3">
                  <button (click)="addUserToGroup()"
                          [disabled]="!verifyMember()"
                          name="addMember" type="submit"
                          class="btn btn-outline-success text-center
                            text-monospace font-italic font-weight-bolder">
                    Add a member
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <br>

        <div *ngIf="!groupUsers">
          <app-spinner></app-spinner>
        </div>
        <!--Table-->
        <table *ngIf="groupUsers" class="table table-striped w-auto .table-sm table table-bordered">

          <!--Table head-->
          <thead>
          <tr>
            <!-- group number -->
            <th scope="col">#
              <i class="fa fa-sort-numeric-asc" aria-hidden="true"></i>
            </th>
            <th>username</th>
            <th>email</th>
            <th>role</th>
          </tr>
          </thead>
          <!--Table head-->

          <!-- Table body -->
          <tbody *ngIf="groupUsers" id="demos">
          <ng-container *ngFor="let user of groupUsers index as i">

            <tr>

              <th class="text-monospace font-italic"
                  scope="row"> {{i + 1}} </th>
              <th class="text-monospace font-italic" scope="row">
                {{user['username']}} </th>
              <th class="text-monospace font-italic" scope="row">
                {{user['email']}} </th>
              <th class="text-monospace font-italic" scope="row">
                {{user['roleInThisGroup'].role}} </th>
            </tr>
          </ng-container>
          </tbody>
          <!-- Table body -->
        </table>
        <!--Table-->
        <hr>
        <br>
        <p class="text-monospace font-italic font-weight-bolder h5">
          <strong>Group shopping list</strong>
        </p>
        <br>
        <div class="container">
          <fieldset class="md-form form-inline">
            <div class="form-group">
              <label for="typeahead-http">Search for products:</label>
              <input id="typeahead-http" type="text"
                     class="form-control mx-sm-3"
                     [class.is-invalid]="searchFailed"
                     [(ngModel)]="productModel" name="addProductInput"
                     [inputFormatter]="productFormatter"
                     [resultFormatter]="productFormatter" [ngbTypeahead]="productList"
                     placeholder="Product name"/>
              <br>
              <small *ngIf="searching" class="form-text text-muted">searching...</small>
              <div class="invalid-feedback" *ngIf="searchFailed">Sorry, no product name was found
                with this name : {{productModel}}</div>
            </div>
            <label for="quantityInput">
              <input
                [disabled]="!verifyProduct()"
                class="btn btn-outline-success text-center
                  text-monospace font-italic font-weight-bolder"
                [(ngModel)]="quantity" name="quantity"
                type="number" id="quantityInput" min="1" max="20"
                placeholder="1">
            </label>
            <button (click)="addProductToShoppingList()"
                    name="addProduct" type="submit"
                    [disabled]="!verifyProduct()"
                    class="btn btn-outline-success text-center mx-sm-3
              text-monospace font-italic font-weight-bolder">Add a product
            </button>
          </fieldset>
          <hr>
        </div>

        <div *ngIf="groupProducts.length !== 0" class="container mb-4">
          <div class="row">
            <div class="col-12">
              <div class="table-responsive">
                <table class="table table-striped .table-sm table table-bordered">
                  <thead class="font-weight-bold">
                  <tr>
                    <th class="text-monospace font-italic"></th>
                    <th class="text-monospace font-italic">Product</th>
                    <th class="text-monospace font-italic">Username</th>
                    <th class="text-monospace font-italic">Quantity</th>
                    <th class="text-monospace font-italic">Action</th>
                  </tr>
                  </thead>
                  <tbody *ngIf="groupProducts">
                  <ng-container *ngFor="let product of groupProducts index as i">
                    <tr>
                      <td><img src="../../../../../assets/img/product.png" alt=""/></td>
                      <td><strong class="text-monospace font-italic">
                        {{product['product_name']}}</strong></td>
                      <td class="text-monospace font-italic">{{product['username']}}</td>
                      <td class="text-monospace font-italic">{{product['quantity']}}</td>
                      <td class="text-monospace font-italic">
                        <button
                          [disabled]="!(product['username'] === currentUser)"
                          class="btn btn-sm btn-danger justify-content-center">
                          <i class="fa fa-trash"></i></button>
                      </td>
                    </tr>
                  </ng-container>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <div *ngIf="groupProducts.length === 0" class="container mb-4">
          <h6 class="text-monospace font-italic font-weight-bolder">
            <i class="fa fa-info-circle" aria-hidden="true" style="color: green"></i>
            This group has no shopping list at the moment !
          </h6>
        </div>
        <hr>
        <div class="p-4">
          <p class="font-italic mb-4">
            <i class="fa fa-info-circle" aria-hidden="true" style="color: green"></i>
            Shipping and additional costs are calculated based on values you have
            entered.</p>
          <ul class="list-unstyled mb-4">
            <li class="d-flex justify-content-between py-3 border-bottom">
              <strong class="text-muted">Order Subtotal </strong>
              <strong>€390.00</strong>
            </li>
            <li class="d-flex justify-content-between py-3 border-bottom">
              <strong class="text-muted">Shipping and handling</strong>
              <strong>€10.00</strong>
            </li>
            <li class="d-flex justify-content-between py-3 border-bottom">
              <strong class="text-muted">Tax</strong>
              <strong>€0.00</strong>
            </li>
            <li class="d-flex justify-content-between py-3 border-bottom">
              <strong class="text-muted">Total</strong>
              <h5 class="font-weight-bold">€400.00</h5>
            </li>
          </ul>
          <a class="btn btn-dark rounded-pill py-2 btn-block
          text-monospace font-weight-bolder h4">
            Procceed to checkout</a>
        </div>
      </div>
    </div>
  </div>
</div>


